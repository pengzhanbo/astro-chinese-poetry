---
import Breadcrumb from '~/components/Breadcrumb.astro'
import PostContent from '~/components/PostContent.astro'
import PrevNext from '~/components/PrevNext.astro'
import news from '~/database/sanzijing-new.json'
import traditional from '~/database/sanzijing-traditional.json'
import Layout from '~/layouts/Layout.astro'
import { getPoetriesConfig, pervNext } from '~/supports'
import type { SanZiJing } from '~/types'

export interface Props {
  post: SanZiJing
  index: number
}

export function getStaticPaths() {
  return [
    { params: { title: 'new' }, props: { post: news, index: 0 } },
    {
      params: { title: 'traditional' },
      props: { post: traditional, index: 1 },
    },
  ]
}

const poetry = getPoetriesConfig('san-zi-jing')!

const { title, id } = poetry
const { paragraphs, tags, author, title: postTitle } = Astro.props.post

const { prev, next } = pervNext(
  ['new', 'traditional'],
  Astro.props.index,
  (type) => ({
    text: type === 'new' ? news.tags : traditional.tags,
    link: `/${id}/${type}`,
  }),
)
---

<Layout title={title}>
  <div class="py-6 px-5 md:px-10 pb-20">
    <Breadcrumb list={[{ text: title, active: true, link: `/${id}` }]} />
    <div class="flex-1 mb-2 text-center">
      <h3 class="text-2xl font-bold text-brand mt-10 mb-4">
        {postTitle}
      </h3>
      <p class="flex justify-center items-center text-text-2">
        <span class="mr-4">[{author}]</span>
        <span>[{tags}]</span>
      </p>
      <PostContent content={paragraphs} />
    </div>
    <PrevNext {prev} {next} />
  </div>
</Layout>
